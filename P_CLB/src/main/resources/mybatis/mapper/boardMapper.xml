<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.mycompany.product_comments.Product_commentsDAO">

	<select id="getProduct_comments" parameterType="string" resultType="com.mycompany.product_comments.Product_commentsVO">
		SELECT PC_NO, P_NO, C_NAME, C_CONTENTS, INSERTID, UPDATEID, INSERTDATE, UPDATEDAY, YN, C_TITLE FROM product_comments WHERE pc_no = #{pc_no}
	</select>

	<select id="getProduct_commentsList" resultType="map">
		SELECT PC_NO, P_NO, C_NAME, C_CONTENTS, INSERTID, UPDATEID, INSERTDATE, UPDATEDAY, YN, C_TITLE FROM product_comments ORDER BY 1 DESC
	</select>

	<select id="getProduct_commentsList2" parameterType="com.mycompany.product_comments.Product_commentsVO" resultType="com.mycompany.product_comments.Product_commentsVO">
		SELECT PC_NO, P_NO, C_NAME, C_CONTENTS, INSERTID, UPDATEID, INSERTDATE, UPDATEDAY, YN, C_TITLE FROM product_comments 
		<where>
		<if test="searchCondition != null and searchCondition == 'c_title'">
			AND c_title like '%'|| #{searchKeyword} ||'%'
		</if>
		<if test="searchCondition != null and searchCondition == 'c_contents'">
			AND c_contents like '%'|| #{searchKeyword} ||'%'
		</if>
		</where>
		ORDER BY 1 DESC
	</select>

	<insert id="insertProduct_comments" parameterType="com.mycompany.product_comments.Product_commentsVO">
		<selectKey keyProperty="pc_no" resultType="string" order="BEFORE">
			select max(pc_no)+1 from product_comments
		</selectKey>
		INSERT INTO product_comments VALUES ((SELECT MAX(pc_no) + 1 FROM product_comments), #{p_no}, #{c_name}, #{c_contents}, #{insertid}, #{updateid}, SYSDATE, SYSDATE, #{yn}, #{c_title})
	</insert>

	<update id="updateBoard" parameterType="com.mycompany.product_comments.Product_commentsVO">
		UPDATE product_comments
		SET c_title=#{c_title}
		   ,writer=#{writer}
		   ,content=#{content}
		WHERE seq=#{seq}
	</update>

	<delete id="deleteBoard" parameterType="int">
		DELETE FROM board WHERE seq=#{seq}
	</delete>

</mapper>
