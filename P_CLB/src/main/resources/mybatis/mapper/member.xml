<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spring.myapp">
       
 
    <select id="getTotalMemberCnt" resultType="int" parameterType="hashMap" >       
		SELECT count(*)
		FROM member	
		<where>
		    <if test="name != '' and tel != ''">
		        name like concat('%', #{name}, '%') AND tel like concat('%', #{tel}, '%')
		    </if>
		    <if test="name != '' and tel == ''">
		        name like concat('%', #{name}, '%')
		    </if>
		    <if test="name == '' and tel != ''">
		        tel like concat('%', #{tel}, '%')
		    </if>
		</where>	
	</select>
	
    <select id="getAllMember" resultType="com.spring.myapp.model.Member" parameterType="hashMap" >       
		SELECT
			no,
			member_no,
			name,
			birth_date,
			sex,
			member_ship,
	        tel,
			contents,
			weekdys,
			weekend,
			affiliation,
			member_class
		FROM
			member
		<where>
		    <if test="name != '' and tel != ''">
		        (name like concat('%', #{name}, '%') AND tel like concat('%', #{tel}, '%')) ORDER BY name ASC LIMIT #{start}, #{pageLimit}
		    </if>
		    <if test="name != '' and tel == ''">
		        name like concat('%', #{name}, '%') ORDER BY name ASC LIMIT #{start}, #{pageLimit}
		    </if>
		    <if test="name == '' and tel != ''">
		        tel like concat('%', #{tel}, '%') ORDER BY name ASC LIMIT #{start}, #{pageLimit}
		    </if>
		</where>	
	</select>
	
	<select id="getMember_detail" resultType="com.spring.myapp.model.Member" parameterType="hashMap" >       
		SELECT
			no,
			member_no,
			name,
			birth_date,
			sex,
			member_ship,
	        tel,
			contents,
			weekdys,
			weekend,
			affiliation,
			member_class
		FROM
			member
		WHERE	
			member_no like concat('', #{member_no}, '%')
	</select>
	
</mapper>
